<!-- resources/mapper/CompanyApplicationQueryMapper.xml -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.hit.hradar.domain.companyApplication.query.infra.mapper.ComAppQueryMapper">

  <select id="findList"
    parameterType="org.hit.hradar.domain.companyApplication.query.dto.ComAppSearchCondition"
    resultType="org.hit.hradar.domain.companyApplication.query.dto.ComAppListItemResponse">


  SELECT
    application_id AS applicationId,
    company_name AS comName,
    biz_no AS bizNo,
    company_admin_name AS comAdminName,
    company_admin_email AS comAdminEmail,
    company_admin_login_id AS comAdminLoginId,
    status AS status,
    created_at AS createdAt
    FROM company_application
    WHERE 1=1

    <if test="status != null">
      AND status = #{status}
    </if>

    <if test="keyword != null and keyword.trim() != ''">
      AND (
      company_name LIKE CONCAT('%', #{keyword}, '%')
      OR biz_no LIKE CONCAT('%', #{keyword}, '%')
      OR company_admin_login_id LIKE CONCAT('%', #{keyword}, '%')
      )
    </if>

    ORDER BY created_at DESC
  </select>

</mapper>
